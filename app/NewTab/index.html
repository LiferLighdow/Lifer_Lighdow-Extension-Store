<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">NewTab——Lifer_Lighdow - 您的專屬新分頁體驗</title>
    <!-- 載入 Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1A202C; /* 深灰藍背景 */
            color: #E2E8F0; /* 淺灰色文字 */
            overflow-x: hidden; /* 防止水平滾動條 */
        }
        .header-gradient {
            background: linear-gradient(90deg, #4299E1, #805AD5); /* 藍色到紫色漸層 */
        }
        .feature-icon {
            color: #C084FC; /* 紫色主題色 */
        }
        .install-button {
            transition: all 0.3s ease;
        }
        .install-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(100, 20, 255, 0.4);
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }
        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: #2D3748;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            max-width: 90%;
            width: 400px;
            text-align: center;
            position: relative;
        }
        .modal-close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: #A0AEC0;
            cursor: pointer;
            font-size: 1.5rem;
        }
    </style>
</head>
<body class="bg-gray-900">

    <!-- Header (與商店首頁類似) -->
    <header class="bg-gray-800 shadow-md py-4 px-6 md:px-12 flex flex-col md:flex-row items-center justify-between sticky top-0 z-50 border-b-2 border-purple-600">
        <div class="flex items-center mb-4 md:mb-0">
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chrome text-blue-400 mr-3">
                <circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="4"/><line x1="22.2" x2="16.4" y1="9" y2="9"/><line x1="22.2" x2="16.4" y1="15" y2="15"/><line x1="9" x2="9" y1="1.8" y2="7.6"/><line x1="15" x2="15" y1="1.8" y2="7.6"/>
            </svg>
            <h1 class="text-3xl font-bold text-transparent bg-clip-text header-gradient" data-i18n-key="header_title">Lifer_Lighdow</h1>
        </div>
        <div class="flex items-center">
            <label for="page-language-selector" class="text-gray-300 mr-2 text-sm" data-i18n-key="language_selector_label">語言：</label>
            <select id="page-language-selector" class="p-2 rounded-md bg-gray-700 border border-gray-600 focus:outline-none focus:border-blue-500 text-white text-sm">
                <option value="zh-TW">繁體中文</option>
                <option value="zh-CN">简体中文</option>
                <option value="en">English</option>
                <option value="ja">日本語</option>
            </select>
        </div>
    </header>

    <!-- Language Selection Modal Container -->
    <div id="language-selection-modal-container" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-2xl font-bold text-white mb-4" data-i18n-key="modal_title">選擇語言</h2>
            <p class="text-gray-300 mb-6" data-i18n-key="modal_instruction">請選擇您希望擴充功能介面使用的語言：</p>
            <select id="modal-language-selector" class="w-full p-3 rounded-md bg-gray-700 border border-gray-600 focus:outline-none focus:border-purple-500 text-white text-base mb-8">
                <option value="zh-TW">繁體中文</option>
                <option value="zh-CN">简体中文</option>
                <option value="en">English</option>
                <option value="ja">日本語</option>
            </select>
            <div class="flex justify-center gap-4">
                <button id="modal-confirm-btn" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-md shadow transition duration-200 install-button text-lg" data-i18n-key="modal_confirm_button">
                    確認並下載
                </button>
                <button id="modal-cancel-btn" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-md shadow transition duration-200 text-lg" data-i18n-key="modal_cancel_button">
                    取消
                </button>
            </div>
        </div>
    </div>

    <div class="min-h-screen flex flex-col items-center justify-center p-4 sm:p-8">

        <!-- Hero Section -->
        <section class="text-center mb-16 max-w-4xl w-full">
            <h1 class="text-5xl sm:text-6xl md:text-7xl font-extrabold mb-6 leading-tight text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-400 animate-pulse" data-i18n-key="hero_main_title">
                NewTab——Lifer_Lighdow
            </h1>
            <p class="text-xl sm:text-2xl text-gray-300 mb-8 max-w-2xl mx-auto" data-i18n-key="hero_subtitle">
                將您的 Chrome 新分頁轉變為個性化的生產力中心！
            </p>
            <a href="javascript:void(0);" id="install-button" class="inline-flex items-center justify-center bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 px-8 rounded-full shadow-lg install-button text-lg" data-i18n-key="install_button_text">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-download mr-3">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/>
                </svg>
                立即安裝擴充功能
            </a>
            <p class="text-sm text-gray-400 mt-4 max-w-lg mx-auto">
                <strong class="text-yellow-400" data-i18n-key="install_note_important">注意：</strong> <span data-i18n-key="install_note_text">Chrome 瀏覽器通常不允許直接安裝此類 .crx 檔案。您可能需要前往 <code class="bg-gray-700 px-1 rounded">chrome://extensions/</code> 並開啟「開發人員模式」，然後將下載的檔案拖曳到頁面中來安裝。</span>
            </p>
        </section>

        <!-- Features Section -->
        <section class="w-full max-w-5xl mb-16">
            <h2 class="text-4xl font-bold text-center mb-12 text-blue-300" data-i18n-key="features_title">主要功能</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Feature Card 1: 時間與日期 -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300 flex flex-col items-center text-center border border-gray-700 hover:border-blue-500 card-hover">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock feature-icon mb-4">
                        <circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>
                    </svg>
                    <h3 class="text-2xl font-semibold mb-2 text-white" data-i18n-key="feature_time_title">即時時間與日期</h3>
                    <p class="text-gray-400" data-i18n-key="feature_time_desc">隨時掌握當前時間與詳細日期。</p>
                </div>

                <!-- Feature Card 2: 快速連結 -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300 flex flex-col items-center text-center border border-gray-700 hover:border-green-500 card-hover">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link feature-icon mb-4">
                        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07L9 7.07A5 5 0 0 0 5.46 10.46l-3 3a5 5 0 0 0 7.07 7.07L15 16.93a5 5 0 0 0 0-7.07Z"/>
                    </svg>
                    <h3 class="text-2xl font-semibold mb-2 text-white" data-i18n-key="feature_links_title">自定義快速連結</h3>
                    <p class="text-gray-400" data-i18n-key="feature_links_desc">輕鬆添加您常用網站的快速入口。</p>
                </div>

                <!-- Feature Card 3: 筆記 -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300 flex flex-col items-center text-center border border-gray-700 hover:border-yellow-500 card-hover">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-notebook-pen feature-icon mb-4">
                        <path d="M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.4L13.4 2Z"/><path d="M22 12.5v6.5a2 2 0 0 1-2 2h-1c-.33 0-.6-.1-.83-.24s-.3-.42-.32-.6a.5.5 0 0 1 .1-.54c.3-.3 1-.72 1.7-1.4l.27-.27c.45-.45.7-.85.73-1.07a.5.5 0 0 0 .1-.54c-.3-.3-1-.72-1.7-1.4l-.27-.27c-.45-.45-.85-.7-1.07-.73a.5.5 0 0 0-.54.1c-.3.3-.72 1-.4 1.7l-.27-.27c-.45-.45-.7-.85-.73-1.07a.5.5 0 0 0-.54.1c-.3.3-.72 1-.4 1.7L12 17l4-4 6-6V7.5l-2-2z"/><path d="M18 10V6"/><path d="M10 2v4"/><path d="M10 10v4"/>
                    </svg>
                    <h3 class="text-2xl font-semibold mb-2 text-white" data-i18n-key="feature_notes_title">內建筆記本</h3>
                    <p class="text-gray-400" data-i18n-key="feature_notes_desc">快速記錄您的想法，支援自動保存。</p>
                </div>

                <!-- Feature Card 4: 天氣 -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300 flex flex-col items-center text-center border border-gray-700 hover:border-yellow-500 card-hover">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-sun feature-icon mb-4">
                        <path d="M12 2v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="M2 12h2"/><path d="m4.93 19.07 1.41-1.41"/><path d="M12 22v-2"/><path d="m19.07 19.07-1.41-1.41"/><path d="M22 12h-2"/><path d="m19.07 4.93-1.41 1.41"/><path d="M16 12a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4 4.5 4.5 0 0 0 4.5 4H15a2.5 2.5 0 0 0 .5-5Z"/>
                    </svg>
                    <h3 class="text-2xl font-semibold mb-2 text-white" data-i18n-key="feature_weather_title">即時天氣資訊</h3>
                    <p class="text-gray-400" data-i18n-key="feature_weather_desc">自定義城市，隨時查看當地天氣概況。</p>
                </div>

                <!-- Feature Card 5: 待辦事項 -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300 flex flex-col items-center text-center border border-gray-700 hover:border-blue-500 card-hover">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list-todo feature-icon mb-4">
                        <rect x="3" y="5" width="6" height="6" rx="1"/><path d="M7 19h14"/><path d="M7 15h14"/><path d="M14 5h7"/>
                    </svg>
                    <h3 class="text-2xl font-semibold mb-2 text-white" data-i18n-key="feature_todos_title">簡單待辦事項</h3>
                    <p class="text-gray-400" data-i18n-key="feature_todos_desc">管理您的任務清單，保持高效。</p>
                </div>

                <!-- Feature Card 6: AI 聊天 -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300 flex flex-col items-center text-center border border-gray-700 hover:border-purple-500 card-hover">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-square-text feature-icon mb-4">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/><path d="M13 8H7"/><path d="M17 12H7"/>
                    </svg>
                    <h3 class="text-2xl font-semibold mb-2 text-white" data-i18n-key="feature_ai_title">整合 AI 聊天</h3>
                    <p class="text-gray-400" data-i18n-key="feature_ai_desc">隨時與 Gemini AI 互動，支援語音輸入與匯出入。</p>
                </div>

                <!-- Feature Card 7: 自定義主題 -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300 flex flex-col items-center text-center border border-gray-700 hover:border-orange-500 card-hover">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-palette feature-icon mb-4">
                        <circle cx="12" cy="12" r="10"/><path d="M16 7s-4.5 5.5-8 8c3.5 1.5 5.5 1.5 8 0z"/><circle cx="12" cy="12" r="2"/>
                    </svg>
                    <h3 class="text-2xl font-semibold mb-2 text-white" data-i18n-key="feature_theme_title">豐富主題設定</h3>
                    <p class="text-gray-400" data-i18n-key="feature_theme_desc">選擇漸層背景或使用外部圖片 URL 作為背景。</p>
                </div>
            </div>
        </section>

        <!-- Call to Action Section (Repeat) -->
        <section class="text-center mb-16 max-w-4xl w-full">
            <h2 class="text-4xl sm:text-5xl font-bold mb-6 text-purple-300" data-i18n-key="final_cta_title">立即開始您的個性化新分頁體驗！</h2>
            <a href="javascript:void(0);" id="install-button-bottom" class="inline-flex items-center justify-center bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 px-8 rounded-full shadow-lg install-button text-lg" data-i18n-key="download_ext_name_button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-download mr-3">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/>
                </svg>
                下載擴充功能檔案
            </a>
            <p class="text-sm text-gray-400 mt-4 max-w-lg mx-auto">
                <strong class="text-yellow-400" data-i18n-key="install_note_important">注意：</strong> <span data-i18n-key="install_note_text">Chrome 瀏覽器通常不允許直接安裝此類 .crx 檔案。您可能需要前往 <code class="bg-gray-700 px-1 rounded">chrome://extensions/</code> 並開啟「開發人員模式」，然後將下載的檔案拖曳到頁面中來安裝。</span>
            </p>
        </section>

        <!-- Footer -->
        <footer class="w-full text-center py-8 text-gray-500 border-t border-gray-700">
            <p data-i18n-key="footer_text">&copy; 2025 NewTab by Lifer_Lighdow. All rights reserved.</p>
        </footer>

    </div>

    <script>
        const translations = {
            'zh-TW': {
                'page_title': 'NewTab——Lifer_Lighdow - 您的專屬新分頁體驗',
                'header_title': 'Lifer_Lighdow',
                'language_selector_label': '語言：',
                'hero_main_title': 'NewTab——Lifer_Lighdow',
                'hero_subtitle': '將您的 Chrome 新分頁轉變為個性化的生產力中心！',
                'install_button_text': '立即安裝擴充功能',
                'install_note_important': '注意：',
                'install_note_text': 'Chrome 瀏覽器通常不允許直接安裝此類 .crx 檔案。您可能需要前往 chrome://extensions/ 並開啟「開發人員模式」，然後將下載的檔案拖曳到頁面中來安裝。',
                'features_title': '主要功能',
                'feature_time_title': '即時時間與日期',
                'feature_time_desc': '隨時掌握當前時間與詳細日期。',
                'feature_links_title': '自定義快速連結',
                'feature_links_desc': '輕鬆添加您常用網站的快速入口。',
                'feature_notes_title': '內建筆記本',
                'feature_notes_desc': '快速記錄您的想法，支援自動保存。',
                'feature_weather_title': '即時天氣資訊',
                'feature_weather_desc': '自定義城市，隨時查看當地天氣概況。',
                'feature_todos_title': '簡單待辦事項',
                'feature_todos_desc': '管理您的任務清單，保持高效。',
                'feature_ai_title': '整合 AI 聊天',
                'feature_ai_desc': '隨時與 Gemini AI 互動，支援語音輸入與匯出入。',
                'feature_theme_title': '豐富主題設定',
                'feature_theme_desc': '選擇漸層背景或使用外部圖片 URL 作為背景。',
                'final_cta_title': '立即開始您的個性化新分頁體驗！',
                'download_ext_name_button': '下載擴充功能檔案',
                'footer_text': '&copy; 2025 NewTab by Lifer_Lighdow. All rights reserved.',
                'modal_title': '選擇語言',
                'modal_instruction': '請選擇您希望擴充功能介面使用的語言：',
                'modal_confirm_button': '確認並下載',
                'modal_cancel_button': '取消',
            },
            'zh-CN': {
                'page_title': 'NewTab——Lifer_Lighdow - 您的专属新标签页体验',
                'header_title': 'Lifer_Lighdow',
                'language_selector_label': '语言：',
                'hero_main_title': 'NewTab——Lifer_Lighdow',
                'hero_subtitle': '将您的 Chrome 新标签页转变为个性化的生产力中心！',
                'install_button_text': '立即安装扩展程序',
                'install_note_important': '注意：',
                'install_note_text': 'Chrome 浏览器通常不允许直接安装此类 .crx 文件。您可能需要前往 chrome://extensions/ 并开启“开发者模式”，然后将下载的文件拖拽到页面中来安装。',
                'features_title': '主要功能',
                'feature_time_title': '实时时间与日期',
                'feature_time_desc': '随时掌握当前时间与详细日期。',
                'feature_links_title': '自定义快速链接',
                'feature_links_desc': '轻松添加您常用网站的快速入口。',
                'feature_notes_title': '内置笔记本',
                'feature_notes_desc': '快速记录您的想法，支持自动保存。',
                'feature_weather_title': '实时天气信息',
                'feature_weather_desc': '自定义城市，随时查看当地天气概况。',
                'feature_todos_title': '简单待办事项',
                'feature_todos_desc': '管理您的任务清单，保持高效。',
                'feature_ai_title': '集成 AI 聊天',
                'feature_ai_desc': '随时与 Gemini AI 互动，支持语音输入与导出导入。',
                'feature_theme_title': '丰富主题设置',
                'feature_theme_desc': '选择渐变背景或使用外部图片 URL 作为背景。',
                'final_cta_title': '立即开始您的个性化新标签页体验！',
                'download_ext_name_button': '下载扩展程序文件',
                'footer_text': '&copy; 2025 NewTab by Lifer_Lighdow. All rights reserved.',
                'modal_title': '选择语言',
                'modal_instruction': '请选择您希望扩展程序界面使用的语言：',
                'modal_confirm_button': '确认并下载',
                'modal_cancel_button': '取消',
            },
            'en': {
                'page_title': 'NewTab——Lifer_Lighdow - Your Custom New Tab Experience',
                'header_title': 'Lifer_Lighdow',
                'language_selector_label': 'Language:',
                'hero_main_title': 'NewTab——Lifer_Lighdow',
                'hero_subtitle': 'Transform your Chrome new tab into a personalized productivity hub!',
                'install_button_text': 'Install Extension Now',
                'install_note_important': 'Note:',
                'install_note_text': 'Chrome browser typically does not allow direct installation of .crx files. You may need to go to chrome://extensions/ and enable "Developer mode", then drag and drop the downloaded file onto the page to install.',
                'features_title': 'Key Features',
                'feature_time_title': 'Real-time Time & Date',
                'feature_time_desc': 'Always know the current time and detailed date.',
                'feature_links_title': 'Custom Quick Links',
                'feature_links_desc': 'Easily add quick access to your frequently visited websites.',
                'feature_notes_title': 'Built-in Notebook',
                'feature_notes_desc': 'Quickly jot down your thoughts, with auto-save support.',
                'feature_weather_title': 'Instant Weather Info',
                'feature_weather_desc': 'Customize your city and check local weather conditions anytime.',
                'feature_todos_title': 'Simple To-Do List',
                'feature_todos_desc': 'Manage your task list and stay productive.',
                'feature_ai_title': 'Integrated AI Chat',
                'feature_ai_desc': 'Interact with Gemini AI anytime, with voice input and import/export support.',
                'feature_theme_title': 'Rich Theme Settings',
                'feature_theme_desc': 'Choose gradient backgrounds or use external image URLs for your background.',
                'final_cta_title': 'Start your personalized new tab experience now!',
                'download_ext_name_button': 'Download Extension File',
                'footer_text': '&copy; 2025 NewTab by Lifer_Lighdow. All rights reserved.',
                'modal_title': 'Select Language',
                'modal_instruction': 'Please select the language you want for the extension interface:',
                'modal_confirm_button': 'Confirm & Download',
                'modal_cancel_button': 'Cancel',
            },
            'ja': {
                'page_title': 'NewTab——Lifer_Lighdow - あなた専用の新しいタブ体験',
                'header_title': 'Lifer_Lighdow',
                'language_selector_label': '言語：',
                'hero_main_title': 'NewTab——Lifer_Lighdow',
                'hero_subtitle': 'Chromeの新しいタブをパーソナライズされた生産性ハブに変革しましょう！',
                'install_button_text': '今すぐ拡張機能をインストール',
                'install_note_important': '注意：',
                'install_note_text': 'Chromeブラウザでは通常、.crxファイルの直接インストールは許可されていません。chrome://extensions/に移動して「デベロッパーモード」を有効にし、ダウンロードしたファイルをページにドラッグ＆ドロップしてインストールする必要がある場合があります。',
                'features_title': '主な機能',
                'feature_time_title': 'リアルタイムの時間と日付',
                'feature_time_desc': '現在の時間と詳細な日付をいつでも把握できます。',
                'feature_links_title': 'カスタムクイックリンク',
                'feature_links_desc': '頻繁にアクセスするウェブサイトへのクイックアクセスを簡単に追加できます。',
                'feature_notes_title': '内蔵ノートブック',
                'feature_notes_desc': '考えを素早くメモし、自動保存をサポートします。',
                'feature_weather_title': 'インスタント天気情報',
                'feature_weather_desc': '都市をカスタマイズし、いつでも現地の天気状況を確認できます。',
                'feature_todos_title': 'シンプルなToDoリスト',
                'feature_todos_desc': 'タスクリストを管理し、生産性を維持します。',
                'feature_ai_title': '統合AIチャット',
                'feature_ai_desc': 'いつでもGemini AIと対話し、音声入力とインポート/エクスポートをサポートします。',
                'feature_theme_title': '豊富なテーマ設定',
                'feature_theme_desc': 'グラデーション背景を選択するか、外部の画像URLを背景として使用できます。',
                'final_cta_title': '今すぐパーソナライズされた新しいタブ体験を始めましょう！',
                'download_ext_name_button': '拡張機能ファイルをダウンロード',
                'footer_text': '&copy; 2025 NewTab by Lifer_Lighdow. All rights reserved.',
                'modal_title': '言語を選択',
                'modal_instruction': '拡張機能のインターフェースで使用したい言語を選択してください：',
                'modal_confirm_button': '確認してダウンロード',
                'modal_cancel_button': 'キャンセル',
            }
        };

        function setLanguage(lang) {
            // Update page title
            document.getElementById('page-title').textContent = translations[lang]['page_title'];

            // Update elements with data-i18n-key
            document.querySelectorAll('[data-i18n-key]').forEach(element => {
                const key = element.getAttribute('data-i18n-key');
                if (translations[lang][key]) {
                    // Special handling for placeholder
                    if (element.tagName === 'INPUT' && element.hasAttribute('placeholder')) {
                        element.setAttribute('placeholder', translations[lang][key]);
                    } else if (key === 'install_note_text' || key === 'support_text_combined') {
                        // For these specific keys, update innerHTML as they contain <strong> and <code> tags
                        element.innerHTML = translations[lang][key];
                    }
                    else {
                        element.textContent = translations[lang][key];
                    }
                }
            });

            // Set the lang attribute for the HTML tag
            document.documentElement.lang = lang;

            // Save selected language to localStorage
            localStorage.setItem('selectedLanguage', lang);
        }

        function showLanguageSelectionModal() {
            const modalContainer = document.getElementById('language-selection-modal-container');
            const modalLangSelector = document.getElementById('modal-language-selector');
            const currentLang = localStorage.getItem('selectedLanguage') || 'zh-TW';

            // Set the modal's dropdown to the currently selected page language
            if (modalLangSelector) {
                modalLangSelector.value = currentLang;
            }

            // Apply translations to the modal content itself
            modalContainer.querySelector('[data-i18n-key="modal_title"]').textContent = translations[currentLang]['modal_title'];
            modalContainer.querySelector('[data-i18n-key="modal_instruction"]').textContent = translations[currentLang]['modal_instruction'];
            modalContainer.querySelector('[data-i18n-key="modal_confirm_button"]').textContent = translations[currentLang]['modal_confirm_button'];
            modalContainer.querySelector('[data-i18n-key="modal_cancel_button"]').textContent = translations[currentLang]['modal_cancel_button'];


            modalContainer.classList.remove('hidden');

            // Bind event listeners for modal buttons
            document.getElementById('modal-confirm-btn').onclick = () => {
                const selectedLang = modalLangSelector.value;
                setLanguage(selectedLang); // Set the page language based on modal selection
                // Dynamically construct the filename based on selectedLang
                triggerDownload(`NewTab——Lifer_Lighdow_${selectedLang}.crx`);
                hideLanguageSelectionModal();
            };

            document.getElementById('modal-cancel-btn').onclick = () => {
                hideLanguageSelectionModal();
            };
        }

        function hideLanguageSelectionModal() {
            document.getElementById('language-selection-modal-container').classList.add('hidden');
        }

        function triggerDownload(filename) {
            const a = document.createElement('a');
            a.href = filename; // The full path/filename will be used
            a.download = filename; // Set the download attribute to the desired filename
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        // Initialize language and bind events on page load
        document.addEventListener('DOMContentLoaded', () => {
            const pageLanguageSelector = document.getElementById('page-language-selector');
            const savedLang = localStorage.getItem('selectedLanguage') || 'zh-TW'; // Default to Traditional Chinese

            // Set the page's language dropdown to the saved language
            if (pageLanguageSelector) {
                pageLanguageSelector.value = savedLang;
                pageLanguageSelector.addEventListener('change', (event) => {
                    setLanguage(event.target.value);
                });
            }

            // Apply translations to the entire page
            setLanguage(savedLang);

            // Bind click event to the install buttons
            document.getElementById('install-button').addEventListener('click', (e) => {
                e.preventDefault(); // Prevent default download immediately
                showLanguageSelectionModal();
            });
            document.getElementById('install-button-bottom').addEventListener('click', (e) => {
                e.preventDefault(); // Prevent default download immediately
                showLanguageSelectionModal();
            });
        });
    </script>
</body>
</html>
